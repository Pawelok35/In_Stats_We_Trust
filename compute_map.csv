stat_key,layer,file_path,function,lines,inputs,derived_from,written_to,used_by,tests,display_name,aliases
L1.season,L1,etl/mappers.py,canonicalize_l1,57-98,ingest params,etl/l1_ingest.py:run (provider parquet),data/l1/<season>/<week>.parquet,etl/l2_clean.py:run,tests/test_l1_ingest.py::test_l1_ingest_filesystem_roundtrip,Season,
L1.week,L1,etl/mappers.py,canonicalize_l1,57-98,ingest params,etl/l1_ingest.py:run (provider parquet),data/l1/<season>/<week>.parquet,etl/l2_clean.py:run,tests/test_l1_ingest.py::test_l1_ingest_filesystem_roundtrip,Week,
L1.game_id,L1,etl/mappers.py,canonicalize_l1,57-98,raw['game_id'],etl/l1_ingest.py:run (provider parquet),data/l1/<season>/<week>.parquet,etl/l2_clean.py:run,tests/test_l1_ingest.py::test_l1_ingest_filesystem_roundtrip,Game ID,
L1.play_id,L1,etl/mappers.py,canonicalize_l1,57-98,raw['play_id'],etl/l1_ingest.py:run (provider parquet),data/l1/<season>/<week>.parquet,etl/l2_clean.py:run,tests/test_l1_ingest.py::test_l1_ingest_filesystem_roundtrip,Play ID,
L1.posteam,L1,etl/mappers.py,canonicalize_l1,57-98,raw['posteam'],etl/l1_ingest.py:run (provider parquet),data/l1/<season>/<week>.parquet,etl/l2_clean.py:run,tests/test_l1_ingest.py::test_l1_ingest_filesystem_roundtrip,Possessing team,TEAM (L2)
L1.defteam,L1,etl/mappers.py,canonicalize_l1,57-98,raw['defteam'],etl/l1_ingest.py:run (provider parquet),data/l1/<season>/<week>.parquet,etl/l2_clean.py:run,tests/test_l1_ingest.py::test_l1_ingest_filesystem_roundtrip,Defending team,OPP (L2)
L1.drive,L1,etl/mappers.py,canonicalize_l1,57-98,raw['drive'],etl/l1_ingest.py:run (provider parquet),data/l1/<season>/<week>.parquet,etl/l2_clean.py:run,tests/test_l1_ingest.py::test_l1_ingest_filesystem_roundtrip,Drive number,
L1.play_type,L1,etl/mappers.py,canonicalize_l1,57-98,raw['play_type'],etl/l1_ingest.py:run (provider parquet),data/l1/<season>/<week>.parquet,etl/l2_clean.py:run,tests/test_l1_ingest.py::test_l1_ingest_filesystem_roundtrip,Play type,
L1.epa,L1,etl/mappers.py,canonicalize_l1,57-98,raw['epa'],etl/l1_ingest.py:run (provider parquet),data/l1/<season>/<week>.parquet,etl/l2_clean.py:run,tests/test_l1_ingest.py::test_l1_ingest_filesystem_roundtrip,Expected points added,
L1.success,L1,etl/mappers.py,canonicalize_l1,57-98,raw['success'],etl/l1_ingest.py:run (provider parquet),data/l1/<season>/<week>.parquet,etl/l2_clean.py:run,tests/test_l1_ingest.py::test_l1_ingest_filesystem_roundtrip,Success probability,
L1.yardline_100,L1,etl/mappers.py,canonicalize_l1,57-98,raw['yardline_100'],etl/l1_ingest.py:run (provider parquet),data/l1/<season>/<week>.parquet,etl/l2_clean.py:run,tests/test_l1_ingest.py::test_l1_ingest_filesystem_roundtrip,Field position (to EZ),
L1.down,L1,etl/mappers.py,canonicalize_l1,57-98,raw['down'],etl/l1_ingest.py:run (provider parquet),data/l1/<season>/<week>.parquet,etl/l2_clean.py:run,tests/test_l1_ingest.py::test_l1_ingest_filesystem_roundtrip,Down,
L1.distance,L1,etl/mappers.py,canonicalize_l1,57-98,raw distance/ydstogo,etl/l1_ingest.py:run (provider parquet),data/l1/<season>/<week>.parquet,etl/l2_clean.py:run,tests/test_l1_ingest.py::test_l1_ingest_filesystem_roundtrip,Yards to go,
L2.season,L2,etl/mappers.py,prepare_l2,116-212,L1.season,L1 canonical dataframe,data/l2/<season>/<week>.parquet,etl/l3_aggregate.py:_aggregate,tests/test_l2_clean.py::test_l2_clean_generates_normalized_artifacts,Season,
L2.week,L2,etl/mappers.py,prepare_l2,116-212,L1.week,L1 canonical dataframe,data/l2/<season>/<week>.parquet,etl/l3_aggregate.py:_aggregate,tests/test_l2_clean.py::test_l2_clean_generates_normalized_artifacts,Week,
L2.game_id,L2,etl/mappers.py,prepare_l2,116-212,L1.game_id,L1 canonical dataframe,data/l2/<season>/<week>.parquet,etl/l3_aggregate.py:_aggregate,tests/test_l2_clean.py::test_l2_clean_generates_normalized_artifacts,Game ID,
L2.play_id,L2,etl/mappers.py,prepare_l2,116-212,L1.play_id,L1 canonical dataframe,data/l2/<season>/<week>.parquet,etl/l3_aggregate.py:_aggregate,tests/test_l2_clean.py::test_l2_clean_generates_normalized_artifacts,Play ID,
L2.TEAM,L2,etl/mappers.py,prepare_l2,116-212,L1.posteam,L1 canonical dataframe,data/l2/<season>/<week>.parquet,etl/l3_aggregate.py:_aggregate,tests/test_l2_clean.py::test_l2_clean_generates_normalized_artifacts,Possessing team (normalized),"team (reports, L4)"
L2.OPP,L2,etl/mappers.py,prepare_l2,116-212,L1.defteam,L1 canonical dataframe,data/l2/<season>/<week>.parquet,etl/l3_aggregate.py:_aggregate,tests/test_l2_clean.py::test_l2_clean_generates_normalized_artifacts,Opponent team,
L2.drive,L2,etl/mappers.py,prepare_l2,116-212,L1.drive,L1 canonical dataframe,data/l2/<season>/<week>.parquet,etl/l3_aggregate.py:_aggregate,tests/test_l2_clean.py::test_l2_clean_generates_normalized_artifacts,Drive,
L2.play_type,L2,etl/mappers.py,prepare_l2,116-212,L1.play_type,L1 canonical dataframe,data/l2/<season>/<week>.parquet,etl/l3_aggregate.py:_aggregate,tests/test_l2_clean.py::test_l2_clean_generates_normalized_artifacts,Play type,
L2.epa,L2,etl/mappers.py,prepare_l2,116-212,L1.epa,L1 canonical dataframe,data/l2/<season>/<week>.parquet,etl/l3_aggregate.py:_aggregate,tests/test_l2_clean.py::test_l2_clean_generates_normalized_artifacts,Expected points added,
L2.success,L2,etl/mappers.py,prepare_l2,116-212,L1.success,L1 canonical dataframe,data/l2/<season>/<week>.parquet,etl/l3_aggregate.py:_aggregate,tests/test_l2_clean.py::test_l2_clean_generates_normalized_artifacts,Success probability,
L2.yards_gained,L2,etl/mappers.py,prepare_l2,116-212,raw or null fill,L1 canonical dataframe,data/l2/<season>/<week>.parquet,etl/l3_aggregate.py:_aggregate,tests/test_l2_clean.py::test_l2_clean_generates_normalized_artifacts,Yards gained,
L2.success_bin,L2,etl/mappers.py,prepare_l2,116-212,computed from success,L1 canonical dataframe,data/l2/<season>/<week>.parquet,etl/l3_aggregate.py:_aggregate,tests/test_l2_clean.py::test_l2_clean_generates_normalized_artifacts,Success flag (>=0.5),
L3.season,L3,etl/l3_aggregate.py,_aggregate,42-84,L2.season,L2 cleaned dataframe,data/l3_team_week/<season>/<week>.parquet,metrics/core12.py:compute,tests/test_l3_counts.py::test_l3_aggregation_produces_team_metrics,Season,
L3.week,L3,etl/l3_aggregate.py,_aggregate,42-84,L2.week,L2 cleaned dataframe,data/l3_team_week/<season>/<week>.parquet,metrics/core12.py:compute,tests/test_l3_counts.py::test_l3_aggregation_produces_team_metrics,Week,
L3.TEAM,L3,etl/l3_aggregate.py,_aggregate,42-84,L2.TEAM,L2 cleaned dataframe,data/l3_team_week/<season>/<week>.parquet,metrics/core12.py:compute,tests/test_l3_counts.py::test_l3_aggregation_produces_team_metrics,Team code,team (Core12)
L3.drives,L3,etl/l3_aggregate.py,_aggregate,42-84,group by drive,L2 cleaned dataframe,data/l3_team_week/<season>/<week>.parquet,metrics/core12.py:compute,tests/test_l3_counts.py::test_l3_aggregation_produces_team_metrics,Unique drives,
L3.plays,L3,etl/l3_aggregate.py,_aggregate,42-84,group len,L2 cleaned dataframe,data/l3_team_week/<season>/<week>.parquet,metrics/core12.py:compute,tests/test_l3_counts.py::test_l3_aggregation_produces_team_metrics,Play count,
L3.epa_off_mean,L3,etl/l3_aggregate.py,_aggregate,42-84,mean of epa,L2 cleaned dataframe,data/l3_team_week/<season>/<week>.parquet,metrics/core12.py:compute,tests/test_l3_counts.py::test_l3_aggregation_produces_team_metrics,Mean offensive EPA,
L3.success_rate_off,L3,etl/l3_aggregate.py,_aggregate,42-84,mean of success,L2 cleaned dataframe,data/l3_team_week/<season>/<week>.parquet,metrics/core12.py:compute,tests/test_l3_counts.py::test_l3_aggregation_produces_team_metrics,Offensive success rate,
L3.epa_def_mean,L3,etl/l3_aggregate.py,_aggregate,42-84,mean by OPP,L2 cleaned dataframe,data/l3_team_week/<season>/<week>.parquet,metrics/core12.py:compute,tests/test_l3_counts.py::test_l3_aggregation_produces_team_metrics,Mean defensive EPA allowed,
L3.success_rate_def,L3,etl/l3_aggregate.py,_aggregate,42-84,mean success by OPP,L2 cleaned dataframe,data/l3_team_week/<season>/<week>.parquet,metrics/core12.py:compute,tests/test_l3_counts.py::test_l3_aggregation_produces_team_metrics,Defensive success rate,
L3.tempo,L3,etl/l3_aggregate.py,_aggregate,42-84,plays/drives,L2 cleaned dataframe,data/l3_team_week/<season>/<week>.parquet,metrics/core12.py:compute,tests/test_l3_counts.py::test_l3_aggregation_produces_team_metrics,Plays per drive,
L4Core12.season,L4 Core12,metrics/core12.py,compute,46-126,L3.season,L3 team-week aggregates,data/l4_core12/<season>/<week>.parquet,metrics/power_score.py:compute; app/reports.generate_team_report,tests/test_metrics_core12.py::test_core12_compute_generates_expected_columns,Season,
L4Core12.week,L4 Core12,metrics/core12.py,compute,46-126,L3.week,L3 team-week aggregates,data/l4_core12/<season>/<week>.parquet,metrics/power_score.py:compute; app/reports.generate_team_report,tests/test_metrics_core12.py::test_core12_compute_generates_expected_columns,Week,
L4Core12.TEAM,L4 Core12,metrics/core12.py,compute,46-126,L3.TEAM,L3 team-week aggregates,data/l4_core12/<season>/<week>.parquet,metrics/power_score.py:compute; app/reports.generate_team_report,tests/test_metrics_core12.py::test_core12_compute_generates_expected_columns,Team code,team (PowerScore/report previews)
L4Core12.core_epa_off,L4 Core12,metrics/core12.py,compute,46-126,L3.epa_off_mean,L3 team-week aggregates,data/l4_core12/<season>/<week>.parquet,metrics/power_score.py:compute; app/reports.generate_team_report,tests/test_metrics_core12.py::test_core12_compute_generates_expected_columns,Core EPA offense,
L4Core12.core_epa_def,L4 Core12,metrics/core12.py,compute,46-126,-L3.epa_def_mean,L3 team-week aggregates,data/l4_core12/<season>/<week>.parquet,metrics/power_score.py:compute; app/reports.generate_team_report,tests/test_metrics_core12.py::test_core12_compute_generates_expected_columns,Core EPA defense,
L4Core12.core_sr_off,L4 Core12,metrics/core12.py,compute,46-126,L3.success_rate_off,L3 team-week aggregates,data/l4_core12/<season>/<week>.parquet,metrics/power_score.py:compute; app/reports.generate_team_report,tests/test_metrics_core12.py::test_core12_compute_generates_expected_columns,Core SR offense,
L4Core12.core_sr_def,L4 Core12,metrics/core12.py,compute,46-126,1 - success_rate_def,L3 team-week aggregates,data/l4_core12/<season>/<week>.parquet,metrics/power_score.py:compute; app/reports.generate_team_report,tests/test_metrics_core12.py::test_core12_compute_generates_expected_columns,Core SR defense,
L4Core12.core_ed_sr_off,L4 Core12,metrics/core12.py,compute,46-126,success_rate_off * tempo,L3 team-week aggregates,data/l4_core12/<season>/<week>.parquet,metrics/power_score.py:compute; app/reports.generate_team_report,tests/test_metrics_core12.py::test_core12_compute_generates_expected_columns,Explosive drive SR,
L4Core12.core_third_down_conv,L4 Core12,metrics/core12.py,compute,46-126,0.6*SR + 0.4*EPA,L3 team-week aggregates,data/l4_core12/<season>/<week>.parquet,metrics/power_score.py:compute; app/reports.generate_team_report,tests/test_metrics_core12.py::test_core12_compute_generates_expected_columns,3rd down conversion proxy,
L4PowerScore.season,L4 PowerScore,metrics/power_score.py,compute,78-160,Core12.season,Core12 dataset + config weights,data/l4_powerscore/<season>/<week>.parquet,app/reports.make_charts; app/reports.generate_team_report; app.cli.compare_report,tests/test_powerscore.py::test_powerscore_monotonic,Season,
L4PowerScore.week,L4 PowerScore,metrics/power_score.py,compute,78-160,Core12.week,Core12 dataset + config weights,data/l4_powerscore/<season>/<week>.parquet,app/reports.make_charts; app/reports.generate_team_report; app.cli.compare_report,tests/test_powerscore.py::test_powerscore_monotonic,Week,
L4PowerScore.team,L4 PowerScore,metrics/power_score.py,compute,78-160,Core12.TEAM + alias map,Core12 dataset + config weights,data/l4_powerscore/<season>/<week>.parquet,app/reports.make_charts; app/reports.generate_team_report; app.cli.compare_report,tests/test_powerscore.py::test_powerscore_monotonic,Team code,TEAM (upstream)
L4PowerScore.power_score,L4 PowerScore,metrics/power_score.py,compute,78-160,Core12 metrics * config weights,Core12 dataset + config weights,data/l4_powerscore/<season>/<week>.parquet,app/reports.make_charts; app/reports.generate_team_report; app.cli.compare_report,tests/test_powerscore.py::test_powerscore_monotonic,Weighted PowerScore,
